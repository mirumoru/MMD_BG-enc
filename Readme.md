## MMD_BG-enc
### 『mp4からMMDの背景で読み込めるaviに変換するバッチ』v1.4.2 
[Downloads(ダウンロード)](https://bowlroll.net/file/239319)  
雑な所がありますが許していただけると幸いです。  

このバッチファイルはhttps://jbjbgame.com/post-5749/ ＆ https://jbjbgame.com/post-5981/ を  
参考にして制作しました。この場を借りてお礼申し上げます。  

MMDで読み込めるファイルサイズは2GBなのですが、  
何故か8GBでも読み込めてしまいました。(20GBの動画の読み込みに成功しています。)  
表示されない場合は、フレームを動かしてください。そしたら映るようになるかもしれません。  
『必ずしも読み込めるようになるとは限りません。』  
その場合すみませんが他のツールを使って見てください。  
  
もしかしたら「Ut Video」が必要かもしれません。  
エラーが発生した場合は導入してみてください。《エラー一貫》によくあるエラーを書いています。  
[ここ](http://umezawa.dyndns.info/wordpress/?cat=28)からダウンロード出来ます。  

## 《動作環境》
Windows 10/11 (x64)  
MikuMikuDanc Ver9.32  
MikuMikuEffect Ver0.37  


## 《使い方》  
ファイル名にスペースや(特殊)記号を入れるとエラーが発生する可能性があります。  
動画.mp4やvideo.mp4などが無難です。  

ファイル直下に動画を配置して下さい。  
〇〇〇.batをダブルクリックして下さい。そしたら動画のデコードが開始されます。  
簡易版は変換するだけです。サイズの変更は出来ません。  
詳細版は任意の動画サイズに変更出来ます。  
エンコードした動画と音声は「out_〇〇〇」ファイルに保存されされます。  
 無い場合は自動的に生成されます。  
おまけを使う場合は「tool」ファイルがある所に移動さてください。  
旧バージョンはおまけファイルに入っています。  

ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー  
簡易版・詳細版(CPU)でエンコードした動画は20GBでも読み込む事が出来ます。(絶対に読み込むかは分からない)  
ただし、777地点のフレームで動画の読み込みに失敗しました。  
ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー  
NVENCのエンコードに対応しています。動画を最後まで読み込む事が出来ました。  
ffmpeg_nvenc版はffmpegのh264_nvencビデオコーデックを使用しています。  
NVEnc版はNVEncC64を使用しています。  
ただし、フレームの戻る操作がカクつくようになっています。原因不明です。すみません。  
背景→背景AVI表示のチェックを外すと軽くなります。  
画面が真っ黒になっている場合は、フレームを動かすと映ると思います。  
エンコードはffmpegとNVEncC64を使用しています。  
NVENCが利用可能か確認にするには、おまけの中にある「NVENC64利用可能確認バッチ」のbatをご活用ください。  
また、NVEncが使えない場合ははQSVをご利用ください。  
ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー  
CPUメリット・・・・MMDでフレーム操作でカクつかない。  
CPUデメリット・・・容量の多い動画は途中で読み込みエラーになる可能がある。   

GPUメリット・・・・容量の多い動画でも最後まで読み込む事ができる。  
GPUデメリット・・・MMDでフレーム操作で動画がカクつく。(特に戻る場合)  

## 《更新内容》  
「ちょい更新v1.4.2」2022/01/22  
不要のファイルがあったので削除しました。  
Readmeの修正といろいろと追記。  
出力した動画の名前が間違っているのを修正。  
ライセンスを追加。《ライセンス》をご覧ください。  

「今回の更新v1.4.1」2022/01/20  
ffmpegを最新版に更新しました。  
NVEncを64bit版に変更しました。(exeは64bit版でした)  
プログラムの一部を修正、追記しました。  
バージョン確認バッチを作成し、「NVENCが利用可能か確認」を  
「NVENC64利用可能確認バッチ」に名前を変更しました。  


「v1.4」2022/01/14  
NVEnc版を作成しました。そのため出力ファイル名を変更しました。  
従来のNVEnc版はffmpeg_nvenc版に名前を変更しています。  

「変更した出力ファイル名」  
NVEnc版->nv_out_MMD  
QSV版->QSV_out_MMD  
簡易版->Ae_out_MMD ※Ae＝Abridged edition  
カスタマイズ版->Ce_out_MMD ※Ce＝Customized edition  

「v1.3」2021/09/29  
・NVENCのエンコードに対応しました。また、QSV(Intel Quick Sync Video)にも対応しています。  
GPUデコードはMMDがカクつくようになっています。原因不明です。すみません。  
・ffmpegを最新版にアップデートしました。  
  
「v1.2a」2021/09/02  
・エンコードが出来ない問題を修正しました。  
  
「v1.2」2021/09/02  
・Readme.txtとbatの表記・内容を修正。  
・mp4からaviとwavに変換(MMD用)詳細版を作成。  
  
「v1.1」2021/07/27  
・一つのバッチファイルで映像と音声分けれるようになりました。  
・出力したファイル名を変更しました。  
・ffmpegを最新版にアップデートしました。  
  
「v1.0」2020/10/26<br>
作りました～  
  
  
## 《エラー一貫》  
No such file or directory ファイルの名前を変更してください。  
already exists. Overwrite? 動画の上書きをするかです。  
する場合は「Y」しない場合は「N」を押してください。  


## 《注意事項》  
MMD_BG-encを使用して発生した損害,損失,などはみるもる(うp主)は責任を一切負いません。  
自己責任でご利用下さい。  


## 《ライセンス》  
・MITライセンスです。  
・batファイルの改変、配布も可能です。ただし、このReadmeを同封してください。(連絡の必要はありません)  
・このソフトウェアは[ffmpeg](https://ffmpeg.org/)と[NVEnc](https://github.com/rigaya/NVEnc)を使用しています。
ライセンスにつきましては、license.txtをご覧ください。  

## 《更新履歴》  
2022/01/22・公開v1.4.2  
2022/01/20・公開v1.4.1  
2022/01/14・公開v1.4  
2021/09/29・公開v1.3  
2021/09/02・公開v1.2a  
2021/09/02・公開v1.2  
2021/07/27・公開v1.1  
2020/10/26・公開v1.0  
  
作成：mirumoru / みるもるの家  

## 《その他》  

[新紹介動画YouTube](https://youtu.be/C2uDBN-xhe4)  
[旧紹介動画YouTube](https://youtu.be/OZD1nLKz6o4)  

[新紹介動画ニコニコ](https://www.nicovideo.jp/watch/sm39898056)  
[旧紹介動画ニコニコ](https://www.nicovideo.jp/watch/sm37725706)  

[YouTubeチャンネル](https://www.youtube.com/channel/UCBFX9aizNm2pMHndCvnrjvA)  

[bilibili](https://space.bilibili.com/1422965680)  

[ニコニコ](https://www.nicovideo.jp/user/50718637)  

[Twitter](https://twitter.com/mirumoruHouse)  

